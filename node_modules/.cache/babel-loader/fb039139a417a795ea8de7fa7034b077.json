{"ast":null,"code":"var _jsxFileName = \"E:\\\\\\u0423\\u043D\\u0438\\u0432\\u0435\\u0440\\\\3 \\u043A\\u0443\\u0440\\u0441\\\\\\u0410\\u0422\\u0410\\u0420\\u041A\\\\Front\\\\src\\\\components\\\\Login\\\\Login.jsx\",\n    _s = $RefreshSig$();\n\nimport React, { useEffect, useState } from \"react\";\nimport Form from \"react-bootstrap/Form\";\nimport Button from \"react-bootstrap/Button\";\nimport s from \"./Login.module.css\";\nimport imagecol from \"./login_image.png\";\nimport { NavLink } from \"react-router-dom\";\nimport Cabinet from \"../UserCabinet/Cabinet\";\nimport { useHistory } from 'react-router-dom';\nimport { useTranslation } from \"react-i18next\";\nimport \"../../utils/i18next\";\nimport axios from \"axios\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport default function Login({\n  setIsLoggedIn,\n  isLoggedIn,\n  Email,\n  setEmail\n}) {\n  _s();\n\n  const [Password, setPassword] = useState(\"\");\n  const [token, setToken] = useState(\"\");\n  const history = useHistory();\n  const {\n    t\n  } = useTranslation();\n  useEffect(() => {\n    axios.get(\"https://localhost:44332/api/Quest\", {\n      headers: {\n        \"Content-Type\": \"application/json\",\n        \"Accept\": \"application/json\",\n        \"Authorization\": \"Bearer \" + localStorage.getItem(\"tok\")\n      }\n    }).then(respon => {\n      console.log(respon);\n      console.log(respon.data);\n      localStorage.setItem(\"ques\", JSON.stringify(respon.data));\n    });\n  }, []);\n  useEffect(() => {\n    if (localStorage.getItem('user-info') && isLoggedIn == true) {\n      history.push(\"/cabinet\");\n    }\n  }, []);\n\n  async function login(e) {\n    e.preventDefault();\n    let result = await fetch(\"https://localhost:44379/api/User/Login\", {\n      method: 'POST',\n      headers: {\n        \"Content-Type\": \"application/json\",\n        \"Accept\": \"application/json\"\n      },\n      body: JSON.stringify({\n        Email: Email,\n        Password: Password\n      })\n    });\n\n    if (result.status === 200) {\n      result = await result.json();\n      localStorage.setItem(\"user-info\", JSON.stringify(result));\n      localStorage.setItem('isLoggedIn', true);\n      localStorage.setItem(\"tok\", result.access_token);\n      setToken(result);\n      console.log(localStorage.getItem(\"tok\"));\n      setIsLoggedIn(true);\n    } else if (result.status === 404) {\n      alert(\"Вы ввели неправильные данные\");\n    } else if (result.status === 400) {\n      alert(\"Пожалуйста, заполните поля\");\n    }\n  }\n\n  async function isAdminLogin() {\n    let res = await fetch(\"https://localhost:44332/api/Role/Role\", {\n      method: 'GET',\n      headers: {\n        \"Content-Type\": \"application/json\",\n        \"Accept\": \"application/json\",\n        \"Authorization\": \"Bearer \" + localStorage.getItem(\"tok\")\n      }\n    });\n    console.log(res.status);\n    res = await res.json();\n    localStorage.setItem(\"isAdminIn\", JSON.stringify(res));\n    console.log(localStorage.getItem(\"isAdminIn\"));\n  }\n\n  isAdminLogin();\n  return /*#__PURE__*/_jsxDEV(\"form\", {\n    onSubmit: login,\n    className: s.formControl,\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: s.row,\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: s.col_6,\n        children: [/*#__PURE__*/_jsxDEV(\"h5\", {\n          className: s.h5welcome,\n          children: [t(\"login.hello\"), \" \", /*#__PURE__*/_jsxDEV(\"span\", {\n            className: s.craftcuts_red,\n            children: \"QuestRoad\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 93,\n            columnNumber: 64\n          }, this), \" \"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 93,\n          columnNumber: 17\n        }, this), /*#__PURE__*/_jsxDEV(\"h6\", {\n          className: \"mb-5 ml-5\",\n          children: [t(\"login.registration\"), \" \", /*#__PURE__*/_jsxDEV(NavLink, {\n            to: \"/registration\",\n            children: t(\"login.here\")\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 94,\n            columnNumber: 71\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 94,\n          columnNumber: 17\n        }, this), /*#__PURE__*/_jsxDEV(\"h1\", {\n          className: s.login,\n          children: t(\"login.enter\")\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 96,\n          columnNumber: 17\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: s.Login,\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"form-group\",\n            children: [/*#__PURE__*/_jsxDEV(\"input\", {\n              type: \"email\",\n              placeholder: \"email\",\n              onChange: e => setEmail(e.target.value),\n              className: 'form-control' + ' w-50 ' + ' mb-3 ' + s.email_input\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 100,\n              columnNumber: 21\n            }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n              type: \"password\",\n              placeholder: \"password\",\n              onChange: e => setPassword(e.target.value),\n              className: 'form-control' + ' w-50 ' + s.password_input\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 101,\n              columnNumber: 21\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 98,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            type: \"submit\",\n            onClick: isAdminLogin,\n            className: s.btn_login,\n            children: \"Login \"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 103,\n            columnNumber: 21\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 97,\n          columnNumber: 17\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 92,\n        columnNumber: 13\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: s.col_6,\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: s.img_block,\n          children: /*#__PURE__*/_jsxDEV(\"img\", {\n            className: s.imagecol,\n            src: \"mainQuest.jpg\",\n            alt: \"image_left\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 111,\n            columnNumber: 21\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 110,\n          columnNumber: 17\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 109,\n        columnNumber: 13\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 91,\n      columnNumber: 9\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 90,\n    columnNumber: 9\n  }, this);\n}\n\n_s(Login, \"0++K2Q/ykvx1vKMqtc+ih0t62oQ=\", false, function () {\n  return [useHistory, useTranslation];\n});\n\n_c = Login;\n\nvar _c;\n\n$RefreshReg$(_c, \"Login\");","map":{"version":3,"sources":["E:/Универ/3 курс/АТАРК/Front/src/components/Login/Login.jsx"],"names":["React","useEffect","useState","Form","Button","s","imagecol","NavLink","Cabinet","useHistory","useTranslation","axios","Login","setIsLoggedIn","isLoggedIn","Email","setEmail","Password","setPassword","token","setToken","history","t","get","headers","localStorage","getItem","then","respon","console","log","data","setItem","JSON","stringify","push","login","e","preventDefault","result","fetch","method","body","status","json","access_token","alert","isAdminLogin","res","formControl","row","col_6","h5welcome","craftcuts_red","target","value","email_input","password_input","btn_login","img_block"],"mappings":"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","sourcesContent":["import React, {useEffect, useState} from \"react\";\r\nimport Form from \"react-bootstrap/Form\";\r\nimport Button from \"react-bootstrap/Button\";\r\nimport s from \"./Login.module.css\";\r\nimport imagecol from \"./login_image.png\";\r\nimport { NavLink } from \"react-router-dom\";\r\nimport Cabinet from \"../UserCabinet/Cabinet\";\r\nimport { useHistory } from 'react-router-dom';\r\nimport {useTranslation} from \"react-i18next\";\r\nimport \"../../utils/i18next\";\r\nimport axios from \"axios\";\r\n\r\n\r\n\r\nexport default function Login({setIsLoggedIn, isLoggedIn, Email, setEmail}) {\r\n  \r\n    const [Password, setPassword] = useState(\"\");\r\n    const [token, setToken] = useState(\"\");\r\n    const history = useHistory();\r\n    const {t} = useTranslation();\r\n\r\n    useEffect(() => {\r\n        axios\r\n            .get(\"https://localhost:44332/api/Quest\",{\r\n                headers:{\r\n                    \"Content-Type\": \"application/json\",\r\n                    \"Accept\": \"application/json\",\r\n                    \"Authorization\": \"Bearer \"+ localStorage.getItem(\"tok\"),\r\n                }\r\n            })\r\n            .then(\r\n                (respon) => {\r\n                    console.log(respon);\r\n                    console.log(respon.data);\r\n                    localStorage.setItem(\"ques\", JSON.stringify(respon.data));})\r\n    },[]);\r\n\r\n    useEffect(() => {\r\n        if(localStorage.getItem('user-info') && isLoggedIn == true){\r\n            history.push(\"/cabinet\")\r\n        }\r\n    }, [])\r\n\r\n    async function login(e) {\r\n        e.preventDefault();\r\n        let result = await fetch(\"https://localhost:44379/api/User/Login\", {\r\n            method: 'POST',\r\n            headers: {\r\n                \"Content-Type\": \"application/json\",\r\n                \"Accept\": \"application/json\",\r\n            },\r\n            body: JSON.stringify({Email: Email, Password: Password}),\r\n        });\r\n        if(result.status === 200){\r\n            result = await result.json();\r\n            localStorage.setItem(\"user-info\", JSON.stringify(result));\r\n            localStorage.setItem('isLoggedIn', true);\r\n            localStorage.setItem(\"tok\",result.access_token);\r\n            setToken(result);\r\n            console.log(localStorage.getItem(\"tok\"));\r\n            setIsLoggedIn(true);\r\n        }\r\n        else if(result.status === 404){\r\n            alert(\"Вы ввели неправильные данные\");\r\n        }\r\n        else if(result.status === 400){\r\n            alert(\"Пожалуйста, заполните поля\");\r\n        }\r\n    }\r\n    async function isAdminLogin(){\r\n        let res = await fetch(\"https://localhost:44332/api/Role/Role\", {\r\n            method: 'GET',\r\n            headers: {\r\n                \"Content-Type\": \"application/json\",\r\n                \"Accept\": \"application/json\",\r\n                \"Authorization\": \"Bearer \"+ localStorage.getItem(\"tok\"),\r\n            },\r\n        });\r\n        console.log(res.status);\r\n        res = await res.json();\r\n        localStorage.setItem(\"isAdminIn\", JSON.stringify(res));\r\n        console.log(localStorage.getItem(\"isAdminIn\"));\r\n    }\r\n\r\n    isAdminLogin();\r\n\r\n\r\n    \r\n    return (\r\n        <form onSubmit={login} className={s.formControl}>\r\n        <div className={s.row}>\r\n            <div className={s.col_6}>\r\n                <h5 className={s.h5welcome}>{t(\"login.hello\")} <span className={s.craftcuts_red}>QuestRoad</span> </h5>\r\n                <h6 className = \"mb-5 ml-5\">{t(\"login.registration\")} <NavLink to=\"/registration\">{t(\"login.here\")}</NavLink></h6>\r\n\r\n                <h1 className={s.login}>{t(\"login.enter\")}</h1>\r\n                <div className={s.Login}>\r\n                <div className = \"form-group\">\r\n\r\n                    <input type=\"email\" placeholder=\"email\" onChange={(e)=>setEmail(e.target.value)} className={'form-control' + ' w-50 ' + ' mb-3 ' +  s.email_input}/>\r\n                    <input type=\"password\" placeholder=\"password\" onChange={(e)=>setPassword(e.target.value)} className={'form-control' + ' w-50 ' + s.password_input}/>\r\n                    </div>\r\n                    <button type=\"submit\" onClick={isAdminLogin} className={s.btn_login}>Login </button>\r\n\r\n\r\n                </div>\r\n            </div>\r\n\r\n            <div className={s.col_6}>\r\n                <div className={s.img_block}>\r\n                    <img className = {s.imagecol} src=\"mainQuest.jpg\" alt=\"image_left\"></img></div>\r\n            </div>\r\n        </div>\r\n        </form>\r\n    );\r\n}"]},"metadata":{},"sourceType":"module"}